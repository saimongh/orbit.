/* --- CORE THEME VARIABLES --- */
:root {
    /* Default Light */
    --bg-body: #ffffff;
    --bg-sidebar: #f9f9f9;
    --bg-card: #ffffff;
    --text-main: #333333;
    --text-muted: #888888;
    --border-color: #e0e0e0;
    --accent-color: #111111;
    --checkmark-color: #ffffff;
    --shadow: 0 4px 20px rgba(0,0,0,0.05);
    --modal-overlay: rgba(255,255,255,0.9);
    --tag-bg: #f0f0f0;
    --tag-text: #555555;
    --toast-bg: #333333;
    --toast-text: #ffffff;
    --danger-color: #d32f2f;
}

[data-theme="dark"] {
    --bg-body: #121212;
    --bg-sidebar: #1a1a1a;
    --bg-card: #1e1e1e;
    --text-main: #e0e0e0;
    --text-muted: #888888;
    --border-color: #333333;
    --accent-color: #ffffff;
    --checkmark-color: #121212;
    --shadow: 0 4px 20px rgba(0,0,0,0.3);
    --modal-overlay: rgba(0,0,0,0.85);
    --tag-bg: #2d2d2d;
    --tag-text: #aaaaaa;
    --toast-bg: #ffffff;
    --toast-text: #121212;
    --danger-color: #ef5350;
}

/* --- THEME: GREENS --- */
[data-theme="light-green"] { /* Mint Fresh */
    --bg-body: #F6FAF9; --bg-sidebar: #E3F3F0; --bg-card: #ffffff;
    --text-main: #2c3e50; --text-muted: #78909c; --border-color: #CCF0DF;
    --accent-color: #5ba890; --checkmark-color: #ffffff;
    --shadow: 0 4px 20px rgba(168, 219, 202, 0.2); --modal-overlay: rgba(246, 250, 249, 0.9);
    --tag-bg: #E3F3F0; --tag-text: #4a7a6c;
    --toast-bg: #2c3e50; --toast-text: #ffffff; --danger-color: #e57373;
}
[data-theme="dark-green"] { /* Neon Sage */
    --bg-body: #051010; --bg-sidebar: #0b1a1a; --bg-card: #112222;
    --text-main: #e0f2f1; --text-muted: #80cbc4; --border-color: #1f3b3b;
    --accent-color: #00ff9d; --checkmark-color: #051010;
    --shadow: 0 4px 25px rgba(0, 255, 157, 0.05); --modal-overlay: rgba(5, 16, 16, 0.9);
    --tag-bg: #1a3333; --tag-text: #00ff9d;
    --toast-bg: #00ff9d; --toast-text: #051010; --danger-color: #ff5252;
}

/* --- THEME: PURPLES --- */
[data-theme="light-purple"] { /* Lavender Dream */
    --bg-body: #fbfaff; --bg-sidebar: #f3f0ff; --bg-card: #ffffff;
    --text-main: #3c366b; --text-muted: #8b85ad; --border-color: #d6bcfa;
    --accent-color: #9f7aea; --checkmark-color: #ffffff;
    --shadow: 0 4px 20px rgba(159, 122, 234, 0.15); --modal-overlay: rgba(251, 250, 255, 0.9);
    --tag-bg: #f3f0ff; --tag-text: #6b46c1;
    --toast-bg: #44337a; --toast-text: #ffffff; --danger-color: #ff6b6b;
}
[data-theme="dark-purple"] { /* Midnight Violet */
    --bg-body: #110d1c; --bg-sidebar: #1a162e; --bg-card: #231e3d;
    --text-main: #e9d8fd; --text-muted: #9f7aea; --border-color: #44337a;
    --accent-color: #d6bcfa; --checkmark-color: #110d1c;
    --shadow: 0 4px 25px rgba(214, 188, 250, 0.1); --modal-overlay: rgba(17, 13, 28, 0.9);
    --tag-bg: #2d264a; --tag-text: #d6bcfa;
    --toast-bg: #d6bcfa; --toast-text: #110d1c; --danger-color: #ff5252;
}

/* --- THEME: BLUES --- */
[data-theme="light-blue"] { /* Sky Breeze */
    --bg-body: #f0f8ff; --bg-sidebar: #e1f5fe; --bg-card: #ffffff;
    --text-main: #1e3a5f; --text-muted: #607d8b; --border-color: #b3e5fc;
    --accent-color: #29b6f6; --checkmark-color: #ffffff;
    --shadow: 0 4px 20px rgba(41, 182, 246, 0.15); --modal-overlay: rgba(240, 248, 255, 0.9);
    --tag-bg: #e1f5fe; --tag-text: #0277bd;
    --toast-bg: #0277bd; --toast-text: #ffffff; --danger-color: #ff5252;
}
[data-theme="dark-blue"] { /* Abyssal Blue */
    --bg-body: #050a14; --bg-sidebar: #0a192f; --bg-card: #112240;
    --text-main: #e6f1ff; --text-muted: #8892b0; --border-color: #1e3a8a;
    --accent-color: #3b82f6; --checkmark-color: #050a14;
    --shadow: 0 4px 25px rgba(0, 123, 255, 0.1); --modal-overlay: rgba(5, 10, 20, 0.9);
    --tag-bg: #1e3a8a; --tag-text: #60a5fa;
    --toast-bg: #3b82f6; --toast-text: #ffffff; --danger-color: #ef4444;
}

/* --- THEME: RED & PINK --- */
[data-theme="dark-red"] { /* Crimson Core */
    --bg-body: #1a0505; --bg-sidebar: #2b0b0b; --bg-card: #3e1010;
    --text-main: #ffebee; --text-muted: #ef9a9a; --border-color: #b71c1c;
    --accent-color: #ff5252; --checkmark-color: #1a0505;
    --shadow: 0 4px 25px rgba(255, 82, 82, 0.1); --modal-overlay: rgba(26, 5, 5, 0.9);
    --tag-bg: #5c1313; --tag-text: #ff8a80;
    --toast-bg: #ff5252; --toast-text: #1a0505; --danger-color: #ff1744;
}
[data-theme="pink"] { /* Blush Petal */
    --bg-body: #fff0f5; --bg-sidebar: #fce4ec; --bg-card: #ffffff;
    --text-main: #880e4f; --text-muted: #ad1457; --border-color: #f8bbd0;
    --accent-color: #ec407a; --checkmark-color: #ffffff;
    --shadow: 0 4px 20px rgba(236, 64, 122, 0.15); --modal-overlay: rgba(255, 240, 245, 0.9);
    --tag-bg: #fce4ec; --tag-text: #c2185b;
    --toast-bg: #880e4f; --toast-text: #ffffff; --danger-color: #e57373;
}

/* --- THEME: CAFE (Latte & Espresso) --- */
[data-theme="light-cafe"] { /* Latte */
    --bg-body: #EBE7DE; --bg-sidebar: #F5F2EB; --bg-card: #FFFFFF;
    --text-main: #4A3C31; --text-muted: #8C7B70; --border-color: #DBCDBA;
    --accent-color: #9C7C58; --checkmark-color: #FFFFFF;
    --shadow: 0 4px 20px rgba(74, 60, 49, 0.1); --modal-overlay: rgba(235, 231, 222, 0.9);
    --tag-bg: #F0EBE0; --tag-text: #6D4C41;
    --toast-bg: #4A3C31; --toast-text: #ffffff; --danger-color: #A1463E;
}
[data-theme="dark-cafe"] { /* Espresso */
    --bg-body: #231B15; --bg-sidebar: #2D241E; --bg-card: #382E26;
    --text-main: #EBE7DE; --text-muted: #A1887F; --border-color: #4E342E;
    --accent-color: #D7CCC8; --checkmark-color: #231B15;
    --shadow: 0 4px 25px rgba(0, 0, 0, 0.3); --modal-overlay: rgba(35, 27, 21, 0.9);
    --tag-bg: #4E342E; --tag-text: #D7CCC8;
    --toast-bg: #D7CCC8; --toast-text: #231B15; --danger-color: #EF9A9A;
}

/* --- THEME: RANNY --- */
[data-theme="ranny"] {
    --bg-body: #0a0a0a;
    --bg-sidebar: #141414;
    --bg-card: #1c1c1c;
    --text-main: #ffffff;
    --text-muted: #9e9e9e;
    --border-color: #333333;
    --accent-color: #ff70b8;     
    --checkmark-color: #000000;
    --shadow: 0 4px 25px rgba(255, 112, 184, 0.15); 
    --modal-overlay: rgba(0, 0, 0, 0.95);
    --tag-bg: #2e1a22;           
    --tag-text: #ff70b8;
    --toast-bg: #ff70b8;
    --toast-text: #000000;       
    --danger-color: #ff1744;
}

/* --- RANNY VARIANTS --- */

/* 1. Ranny Red */
[data-theme="ranny-red"] {
    --bg-body: #0a0a0a; --bg-sidebar: #141414; --bg-card: #1c1c1c;
    --text-main: #ffffff; --text-muted: #9e9e9e; --border-color: #333333;
    --accent-color: #ff5252; --checkmark-color: #000000;
    --shadow: 0 4px 25px rgba(255, 82, 82, 0.15); --modal-overlay: rgba(0, 0, 0, 0.95);
    --tag-bg: #2e1a1a; --tag-text: #ff5252;
    --toast-bg: #ff5252; --toast-text: #000000; --danger-color: #ff1744;
}

/* 2. Ranny Orange */
[data-theme="ranny-orange"] {
    --bg-body: #0a0a0a; --bg-sidebar: #141414; --bg-card: #1c1c1c;
    --text-main: #ffffff; --text-muted: #9e9e9e; --border-color: #333333;
    --accent-color: #ff9100; --checkmark-color: #000000;
    --shadow: 0 4px 25px rgba(255, 145, 0, 0.15); --modal-overlay: rgba(0, 0, 0, 0.95);
    --tag-bg: #2e221a; --tag-text: #ff9100;
    --toast-bg: #ff9100; --toast-text: #000000; --danger-color: #ff1744;
}

/* 3. Ranny Yellow */
[data-theme="ranny-yellow"] {
    --bg-body: #0a0a0a; --bg-sidebar: #141414; --bg-card: #1c1c1c;
    --text-main: #ffffff; --text-muted: #9e9e9e; --border-color: #333333;
    --accent-color: #ffd600; --checkmark-color: #000000;
    --shadow: 0 4px 25px rgba(255, 214, 0, 0.15); --modal-overlay: rgba(0, 0, 0, 0.95);
    --tag-bg: #2e2b1a; --tag-text: #ffd600;
    --toast-bg: #ffd600; --toast-text: #000000; --danger-color: #ff1744;
}

/* 4. Ranny Mint */
[data-theme="ranny-mint"] {
    --bg-body: #0a0a0a; --bg-sidebar: #141414; --bg-card: #1c1c1c;
    --text-main: #ffffff; --text-muted: #9e9e9e; --border-color: #333333;
    --accent-color: #5ba890; --checkmark-color: #000000;
    --shadow: 0 4px 25px rgba(100, 255, 218, 0.15); --modal-overlay: rgba(0, 0, 0, 0.95);
    --tag-bg: #1a2e28; --tag-text: #64ffda;
    --toast-bg: #64ffda; --toast-text: #000000; --danger-color: #ff1744;
}

/* 5. Ranny Green */
[data-theme="ranny-green"] {
    --bg-body: #0a0a0a; --bg-sidebar: #141414; --bg-card: #1c1c1c;
    --text-main: #ffffff; --text-muted: #9e9e9e; --border-color: #333333;
    --accent-color: #00e676; --checkmark-color: #000000;
    --shadow: 0 4px 25px rgba(0, 230, 118, 0.15); --modal-overlay: rgba(0, 0, 0, 0.95);
    --tag-bg: #1a2e1d; --tag-text: #00e676;
    --toast-bg: #00e676; --toast-text: #000000; --danger-color: #ff1744;
}

/* 6. Ranny Light Blue (Cyan) */
[data-theme="ranny-cyan"] {
    --bg-body: #0a0a0a; --bg-sidebar: #141414; --bg-card: #1c1c1c;
    --text-main: #ffffff; --text-muted: #9e9e9e; --border-color: #333333;
    --accent-color: #00e5ff; --checkmark-color: #000000;
    --shadow: 0 4px 25px rgba(0, 229, 255, 0.15); --modal-overlay: rgba(0, 0, 0, 0.95);
    --tag-bg: #1a2d2e; --tag-text: #00e5ff;
    --toast-bg: #00e5ff; --toast-text: #000000; --danger-color: #ff1744;
}

/* 7. Ranny Blue */
[data-theme="ranny-blue"] {
    --bg-body: #0a0a0a; --bg-sidebar: #141414; --bg-card: #1c1c1c;
    --text-main: #ffffff; --text-muted: #9e9e9e; --border-color: #333333;
    --accent-color: #2979ff; --checkmark-color: #000000;
    --shadow: 0 4px 25px rgba(41, 121, 255, 0.15); --modal-overlay: rgba(0, 0, 0, 0.95);
    --tag-bg: #1a202e; --tag-text: #2979ff;
    --toast-bg: #2979ff; --toast-text: #000000; --danger-color: #ff1744;
}

/* 8. Ranny Purple */
[data-theme="ranny-purple"] {
    --bg-body: #0a0a0a; --bg-sidebar: #141414; --bg-card: #1c1c1c;
    --text-main: #ffffff; --text-muted: #9e9e9e; --border-color: #333333;
    --accent-color: #7c4dff; --checkmark-color: #000000;
    --shadow: 0 4px 25px rgba(124, 77, 255, 0.15); --modal-overlay: rgba(0, 0, 0, 0.95);
    --tag-bg: #241a2e; --tag-text: #7c4dff;
    --toast-bg: #7c4dff; --toast-text: #000000; --danger-color: #ff1744;
}

/* --- GLOBAL STYLES --- */
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: 'Lato', sans-serif;
    background-color: var(--bg-body);
    color: var(--text-main);
    min-height: 100vh;
    padding: 40px 20px;
    transition: background-color 0.3s ease, color 0.3s ease;
    overscroll-behavior-y: none;
}

.container { max-width: 1200px; margin: 0 auto; }

header {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 40px;
    position: relative;
}

h1 {
    font-family: 'Playfair Display', serif;
    font-size: 3rem;
    font-weight: 400;
    color: var(--text-main);
    letter-spacing: 1px;
    font-style: italic;
}

/* HEADER ACTIONS */
.header-actions {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    gap: 10px;
}

.icon-btn-header {
    background: none;
    border: 1px solid var(--border-color);
    color: var(--text-main);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.icon-btn-header:hover {
    border-color: var(--accent-color);
    background: var(--bg-sidebar);
}

.main-content {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: 50px;
    align-items: start;
}

/* SIDEBAR */
.sidebar {
    background: var(--bg-sidebar);
    padding: 30px 20px;
    border-radius: 2px;
    position: sticky;
    top: 20px;
}

.sidebar-header {
    margin-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 15px;
}

/* TAG FILTER SYSTEM */
.filter-wrapper {
    position: relative;
    margin-bottom: 20px;
}

.cat-filter-input {
    width: 100%;
    padding: 10px;
    border: 1px solid var(--border-color);
    background: var(--bg-card);
    border-radius: 4px;
    font-family: 'Lato', sans-serif;
    color: var(--text-main);
    font-size: 13px;
    transition: border-color 0.2s;
}
.cat-filter-input:focus { outline: none; border-color: var(--accent-color); }

.suggestions-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-top: none;
    border-radius: 0 0 4px 4px;
    z-index: 100;
    max-height: 200px;
    overflow-y: auto;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    display: none;
}

.suggestion-item {
    padding: 8px 12px;
    cursor: pointer;
    font-size: 13px;
    color: var(--text-main);
    border-bottom: 1px solid var(--border-color);
}
.suggestion-item:last-child { border-bottom: none; }
.suggestion-item:hover { background: var(--bg-sidebar); color: var(--accent-color); }

.active-tags-container {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 15px;
    min-height: 0;
}

.filter-tag {
    display: inline-flex;
    align-items: center;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 4px 8px;
    font-size: 12px;
    color: var(--text-main);
    gap: 6px;
    animation: fadeIn 0.2s ease;
}
.filter-tag span { font-weight: 500; }

.filter-tag button {
    background: none;           
    border: none;
    color: var(--text-main);
    width: auto;                
    height: auto;               
    border-radius: 0;           
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;            
    cursor: pointer;
    transition: color 0.2s;     
    padding: 0 2px;             
}

.filter-tag button:hover { 
    background: none;
    color: var(--danger-color); 
}

@keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

/* General Search */
.search-container { position: relative; margin-bottom: 15px; }
.search-input {
    width: 100%;
    padding: 8px 30px 8px 10px;
    border: 1px solid var(--border-color);
    background: transparent;
    border-radius: 4px;
    font-family: 'Lato', sans-serif;
    color: var(--text-main);
    font-size: 13px;
}
.search-input:focus { outline: none; border-color: var(--accent-color); }
.search-icon { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); font-size: 12px; color: var(--text-muted); pointer-events: none; }

.sort-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 11px;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 10px;
}

.sort-btn { background: none; border: none; cursor: pointer; color: var(--text-muted); font-weight: 700; display: flex; align-items: center; gap: 5px; }
.sort-btn:hover { color: var(--accent-color); }

/* FIXED CATEGORY ROWS */
.category-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 0;
    border-bottom: 1px solid transparent;
    transition: all 0.2s;
    cursor: default; 
}

.category-name { 
    cursor: pointer; font-size: 15px; flex-grow: 1; 
    transition: padding 0.2s ease; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; 
}

.category-name.active { font-weight: 700; color: var(--accent-color); }
.category-row:hover .category-name { color: var(--accent-color); padding-left: 5px; }

.cat-handle {
    cursor: grab;
    padding: 10px;
    color: var(--border-color);
    font-size: 12px;
    transition: color 0.2s;
    touch-action: none;
}
.cat-handle:hover { color: var(--accent-color); }
.cat-handle:active { cursor: grabbing; }

.cat-count {
    opacity: 0.5; font-size: 0.8em; margin-left: 5px;
}

.sidebar-divider { height: 1px; background: var(--border-color); margin: 20px 0; }

.cat-actions { display: flex; gap: 5px; opacity: 0; transition: opacity 0.2s; }
.category-row:hover .cat-actions { opacity: 1; }
.cat-btn-mini { background: none; border: none; color: var(--text-muted); width: 20px; height: 20px; cursor: pointer; font-size: 11px; display: flex; align-items: center; justify-content: center; border-radius: 4px; }
.cat-btn-mini:hover { color: var(--accent-color); background: rgba(0,0,0,0.05); }
.cat-btn-mini.add { border: 1px solid var(--border-color); border-radius: 50%; width: 22px; height: 22px; opacity: 1 !important; }
.cat-btn-mini.add:hover { border-color: var(--accent-color); }
.cat-btn-mini.delete:hover { color: var(--danger-color); }

.btn-new-category { width: 100%; margin-top: 15px; padding: 10px; background: transparent; border: 1px dashed var(--border-color); color: var(--text-muted); font-size: 12px; cursor: pointer; transition: all 0.2s; text-transform: uppercase; letter-spacing: 1px; }
.btn-new-category:hover { border-color: var(--accent-color); color: var(--accent-color); }

/* ITEMS GRID */
.items-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 25px;
}

.item-card {
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    padding: 25px;
    transition: box-shadow 0.3s ease, border-color 0.3s ease, transform 0.2s ease; 
    position: relative;
    display: flex;
    flex-direction: column;
    user-select: none;
    -webkit-user-select: none;
}

/* Contact Card Pointer Logic */
.item-card.contact-card {
    cursor: pointer;
}
.item-card.contact-card:hover {
    transform: translateY(-3px);
    border-color: var(--accent-color);
    box-shadow: var(--shadow);
}
.item-card.detail-card {
    cursor: grab;
}
.item-card.detail-card:active {
    cursor: grabbing;
}

.item-card.dragging { opacity: 0.4; border: 1px dashed var(--text-muted); box-shadow: none; pointer-events: none; }
.item-card.completed-card { opacity: 0.6; border-style: dashed; }

/* Connection Cards */
.item-card.connection-card {
    border-style: dashed;
}
.connection-badge {
    margin-top: 15px;
    padding-top: 10px;
    border-top: 1px solid var(--border-color);
    font-size: 13px;
    color: var(--text-muted);
    font-style: italic;
    display: flex;
    align-items: center;
    gap: 8px;
}
.connection-badge i {
    font-size: 11px;
    color: var(--accent-color);
}

/* DASHBOARD / UPCOMING EVENTS PREVIEW */
.upcoming-events-preview {
    margin-top: 15px;
    padding-top: 10px;
    border-top: 1px dotted var(--border-color);
}
.event-preview-header {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-muted);
    margin-bottom: 5px;
}
.mini-event-row {
    font-size: 13px;
    color: var(--text-main);
    display: flex;
    gap: 8px;
    margin-bottom: 3px;
}
.mini-date {
    font-weight: 700;
    color: var(--accent-color);
    min-width: 18px;
}
.mini-title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.dragging-clone {
    position: fixed;
    z-index: 9999;
    pointer-events: none;
    opacity: 0.9;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    transform: scale(1.03) rotate(1deg);
    width: 280px;
    background: var(--bg-card);
    border: 1px solid var(--accent-color);
    border-radius: 2px;
    padding: 20px;
}

.item-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px; }
.item-title { font-family: 'Playfair Display', serif; font-size: 1.3rem; color: var(--text-main); margin-right: 10px; line-height: 1.2; }
.completed-card .item-title { text-decoration: line-through; }

.date-badge {
    font-size: 11px;
    color: var(--text-muted);
    display: inline-flex;
    align-items: center;
    gap: 4px;
    margin-top: 5px;
}

/* Action Icons: Invisible by default, Visible on hover */
.item-actions { 
    display: flex; 
    gap: 10px; 
    flex-shrink: 0; 
    margin-top: 5px; 
    opacity: 0; 
    transition: opacity 0.2s ease; 
}
.item-card:hover .item-actions { 
    opacity: 1; 
}

/* Mobile Override for Visibility */
@media (max-width: 768px) {
    .item-actions { opacity: 1 !important; }
}

.item-actions button { background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 14px; transition: all 0.2s; padding: 2px; z-index: 10; }
.item-actions button:hover { transform: scale(1.1); color: var(--accent-color); }
.btn-check:hover { color: #4caf50 !important; }
.btn-delete:hover { color: var(--danger-color) !important; }
.btn-quick-log:hover { color: #4caf50 !important; } /* Quick Log Green Hover */

.item-meta { margin-bottom: 10px; display: flex; flex-direction: column; gap: 5px; }
.item-type { font-size: 10px; text-transform: uppercase; letter-spacing: 2px; padding: 4px 8px; background: var(--tag-bg); color: var(--tag-text); border-radius: 2px; align-self: flex-start; margin-right: 15px;}

.item-description { font-size: 14px; color: var(--text-muted); line-height: 1.6; margin-bottom: 15px; font-weight: 300; }
.item-description strong { font-weight: 700; color: var(--text-main); }
.item-description em { font-style: italic; }
.item-description u { text-decoration: underline; text-decoration-thickness: 1px; text-underline-offset: 2px; }
.item-description s { text-decoration: line-through; opacity: 0.6; }
.item-description a { color: var(--accent-color); text-decoration: underline; font-weight: 500; }
.item-description a:hover { opacity: 0.8; }

/* Avatar */
.avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 700;
    margin-right: 12px;
    flex-shrink: 0;
    border: 1px solid;
}

/* Interaction Icons (History) */
.interaction-icon {
    margin-left: 10px;
    color: var(--text-muted);
}

/* Drift & Last Spoken Tags */
.drift-tag, .last-spoken-tag {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    font-size: 11px;
    padding: 2px 6px;
    border-radius: 4px;
    font-weight: 700;
    margin-left: 10px;
    border: 1px solid currentColor;
}

.drift-tag {
    color: var(--danger-color);
    background: rgba(255, 0, 0, 0.05);
}

.last-spoken-tag {
    color: var(--text-muted);
    background: rgba(0, 0, 0, 0.03);
    font-weight: 400;
}

/* TOAST */
.toast-container { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); display: flex; flex-direction: column; gap: 10px; z-index: 2000; }
.toast { background: var(--toast-bg); color: var(--toast-text); padding: 12px 24px; border-radius: 4px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 15px; font-size: 14px; animation: slideUp 0.3s ease-out; min-width: 300px; justify-content: space-between; }
.toast-undo { background: transparent; border: 1px solid var(--toast-text); color: var(--toast-text); padding: 4px 10px; font-size: 12px; border-radius: 2px; cursor: pointer; text-transform: uppercase; font-weight: 700; }
.toast-undo:hover { opacity: 0.8; }
@keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

.empty-state { grid-column: 1 / -1; text-align: center; padding: 60px 0; color: var(--text-muted); }
.empty-state i { font-size: 48px; margin-bottom: 20px; opacity: 0.3; }
.empty-state p { font-size: 16px; font-weight: 300; }

/* MODALS */
.modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--modal-overlay); backdrop-filter: blur(5px); z-index: 1000; align-items: center; justify-content: center; }
.modal.active { display: flex; }
.modal-content { background: var(--bg-card); padding: 40px; width: 90%; max-width: 500px; border: 1px solid var(--border-color); box-shadow: var(--shadow); max-height: 90vh; overflow-y: auto; }
.modal h2 { font-family: 'Playfair Display', serif; font-weight: 400; font-style: italic; margin-bottom: 30px; font-size: 2rem; color: var(--text-main); text-align: center; }
.form-group { margin-bottom: 25px; }
.date-time-group { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; }
.date-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.btn-clear-date { background: none; border: none; font-size: 11px; color: var(--text-muted); cursor: pointer; text-decoration: underline; }
.btn-clear-date:hover { color: var(--danger-color); }
label { display: block; margin-bottom: 10px; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-muted); }
input[type="text"], input[type="date"], input[type="time"], textarea, select, input[type="number"] { width: 100%; padding: 12px 0; background: transparent; border: none; border-bottom: 1px solid var(--border-color); color: var(--text-main); font-family: 'Lato', sans-serif; font-size: 16px; transition: border-color 0.3s; }
input:focus, textarea:focus, select:focus { outline: none; border-bottom-color: var(--accent-color); }
.form-actions { display: flex; justify-content: flex-end; gap: 20px; margin-top: 40px; }
.btn-text { background: none; border: none; cursor: pointer; font-family: 'Lato', sans-serif; text-transform: uppercase; letter-spacing: 1px; font-size: 12px; color: var(--text-muted); transition: color 0.3s; }
.btn-text.primary { color: var(--text-main); font-weight: 700; border-bottom: 1px solid var(--text-main); padding-bottom: 2px; }
.btn-text:hover { color: var(--accent-color); }

/* SETTINGS MODAL */
.settings-container { display: grid; grid-template-columns: 150px 1fr; gap: 30px; min-height: 300px; }
.settings-nav button { display: block; width: 100%; text-align: left; background: none; border: none; padding: 10px 0; color: var(--text-muted); font-size: 14px; cursor: pointer; border-left: 2px solid transparent; padding-left: 10px; transition: all 0.2s; }
.settings-nav button.active { color: var(--accent-color); border-left-color: var(--accent-color); font-weight: 700; }
.settings-content { border-left: 1px solid var(--border-color); padding-left: 30px; }
.settings-tab { display: none; }
.settings-tab.active { display: block; }
.help-list { font-size: 14px; line-height: 1.8; color: var(--text-main); }
.help-list li { margin-bottom: 10px; }
.help-list strong { color: var(--accent-color); }

.theme-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
.theme-btn { height: 80px; border-radius: 8px; border: 2px solid var(--border-color); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; transition: transform 0.2s; flex-direction: column; gap: 5px; text-align: center; padding: 5px; }
.theme-btn:hover { transform: translateY(-3px); }

/* Theme Previews */
.t-light { background: #ffffff; color: #333; }
.t-dark { background: #121212; color: #fff; border-color: #333; }
.t-mint { background: #F6FAF9; color: #2c3e50; border-color: #CCF0DF; }
.t-neon { background: #051010; color: #00ff9d; border-color: #1f3b3b; }
.t-lpurple { background: #fbfaff; color: #3c366b; border-color: #d6bcfa; }
.t-dpurple { background: #110d1c; color: #d6bcfa; border-color: #44337a; }
.t-lblue { background: #f0f8ff; color: #1e3a5f; border-color: #b3e5fc; }
.t-dblue { background: #050a14; color: #3b82f6; border-color: #1e3a8a; }
.t-pink { background: #fff0f5; color: #880e4f; border-color: #f8bbd0; }
.t-red { background: #1a0505; color: #ff5252; border-color: #b71c1c; }
.t-brown { background: #231B15; color: #D7CCC8; border-color: #4E342E; }
.t-cafe { background: #EBE7DE; color: #4A3C31; border-color: #9C7C58; }
.t-ranny { background: #0a0a0a; color: #ff70b8; border-color: #ff70b8; }

/* Ranny Variant Previews */
.t-ranny-red { background: #0a0a0a; color: #ff5252; border-color: #ff5252; }
.t-ranny-orange { background: #0a0a0a; color: #ff9100; border-color: #ff9100; }
.t-ranny-yellow { background: #0a0a0a; color: #ffd600; border-color: #ffd600; }
.t-ranny-mint { background: #0a0a0a; color: #64ffda; border-color: #64ffda; }
.t-ranny-green { background: #0a0a0a; color: #00e676; border-color: #00e676; }
.t-ranny-cyan { background: #0a0a0a; color: #00e5ff; border-color: #00e5ff; }
.t-ranny-blue { background: #0a0a0a; color: #2979ff; border-color: #2979ff; }
.t-ranny-purple { background: #0a0a0a; color: #7c4dff; border-color: #7c4dff; }

@media (max-width: 768px) {
    .main-content { grid-template-columns: 1fr; }
    .sidebar { position: static; margin-bottom: 40px; }
    .header-actions { position: static; margin-top: 20px; justify-content: center; }
    header { flex-direction: column; }
    .settings-container { grid-template-columns: 1fr; }
    .settings-content { border-left: none; padding-left: 0; border-top: 1px solid var(--border-color); padding-top: 20px; }
}